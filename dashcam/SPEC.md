# Dashcam 仕様書（完成版・最終確定）

---

## 1. 目的

Raspberry Pi 5 上で以下の機能を統合的に提供するダッシュカム／計測可視化システムを構築する。

- カメラモジュール V3（広角）×2  
  - プレビュー表示（MJPEG）
  - 静止画撮影
  - 露出補正（EV）
  - **最高画質での動画撮影（開始／停止）**
- LED ×2 系統の PWM 制御
- 磁気センサによる方位角計測（水平設置前提）
- 距離センサによる距離計測（単位：m）
- 温湿度センサによる外気／筐体内の温湿度計測
- 記録モード時の **センサ別 CSV 保存（開始／終了制御）**
- 保存データ（画像・動画・CSV）を Web UI から参照・ダウンロード

---

## 2. システム構成

### サービス構成（責務分離）

#### UI_service
- Web UI（HTML / CSS / JavaScript）配信
- camera_service / sensor_service の API を呼び出すフロントエンド
- sensor_service の SSE を購読して画面更新
- 記録継続警告ポップアップの表示

#### camera_service
- cam0 / cam1 プレビュー（MJPEG）
- 静止画撮影
- 最高画質動画撮影（開始／停止）
- LED 制御
- **UI の静的配信は行わない**

#### sensor_service
- 磁気・距離・温湿度センサ計測
- SSE 配信（UI 向け）
- 記録モード制御（開始／終了）
- センサ別 CSV 出力
- 記録継続時間監視・警告イベント発行
- クラッシュ／再起動時の記録回収
- ファイルビュワー（画像・動画・CSV の一覧／DL）

---

## 3. UI 仕様
（以下略：これまで提示した完成版仕様と同一）
